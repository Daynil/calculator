{"version":3,"sources":["display-service.ts"],"names":["HistoryItem","HistoryItem.constructor","DisplayService","DisplayService.constructor","DisplayService.appendResult","DisplayService.addOperation","DisplayService.perform","DisplayService.calculate","DisplayService.updateLastPressed","DisplayService.getLastPressed","DisplayService.equals","DisplayService.historySelected","DisplayService.clearAll","DisplayService.clearHistory","DisplayService.delete"],"mappings":"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","file":"display-service.js","sourcesContent":["export class HistoryItem {\r\n\toperationChain: string;\r\n\tresult: number;\r\n\t\r\n\tconstructor(opChain: string[], result: number) {\r\n\t\tthis.operationChain = opChain.join(\" \") + \" =\";\r\n\t\tthis.result = result;\r\n\t}\r\n}\r\n\r\nexport class DisplayService {\r\n\tdisplayResult: string = \"0\";\r\n\tmaxResult: number = 16;\r\n\tdisplayOperation: string = \"\";\r\n\tmaxOperation: number = 41;\r\n\toperationChain: any[] = [];\r\n\tcurrentResult: number = 0;\r\n\tnewResult: boolean = false;\r\n\tfromHistory: boolean = false;\r\n\tlastPressed: string[] = [];\r\n\thistory: HistoryItem[] = [];\r\n\t\r\n\tappendResult(num) {\r\n\t\tif (this.displayResult === \"0\") this.displayResult = \"\";\r\n\t\tif (!this.newResult) {\r\n\t\t\tif (this.displayResult.length < this.maxResult) this.displayResult += num;\r\n\t\t} else {\r\n\t\t\tif (num.toString().length < this.maxResult) {\r\n\t\t\t\tthis.displayResult = num + '';\t\r\n\t\t\t} else {\r\n\t\t\t\tnum = parseFloat(num.toPrecision(this.maxResult-1));\r\n\t\t\t\tif (num.toString().length > this.maxResult) {\r\n\t\t\t\t\tthis.displayResult = num.toExponential(this.maxResult-6);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.displayResult = num + '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.newResult = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\taddOperation(operation: string) {\r\n\t\tif (this.fromHistory) {\r\n\t\t\tthis.operationChain.push(operation);\r\n\t\t\tthis.displayOperation += \" \" + operation + \" \";\r\n\t\t\tthis.fromHistory = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// If we've just pressed an operation previously, switch to new operation\r\n\t\tif ( !( isNaN(this.getLastPressed()) ) || this.operationChain.length === 0 ) {\r\n\t\t\tthis.operationChain.push(this.displayResult);\r\n\t\t\tthis.displayOperation += this.displayResult + \" \" + operation + \" \";\r\n\t\t\tif (this.operationChain.length > 1) {\r\n\t\t\t\tlet result = this.perform(this.operationChain);\r\n\t\t\t\tthis.newResult = true;\r\n\t\t\t\tthis.appendResult(result);\r\n\t\t\t}\r\n\t\t\tthis.operationChain.push(operation);\r\n\t\t\tthis.newResult = true;\r\n\t\t} else {\r\n\t\t\tthis.operationChain.pop();\r\n\t\t\tthis.operationChain.push(operation);\r\n\t\t\tthis.displayOperation = this.displayOperation.slice(0, this.displayOperation.length-2) + operation + \" \";\r\n\t\t}\r\n\t}\r\n\t\r\n\tperform(operationChain): number {\r\n\t\tlet resultBuffer: string = '';\r\n\t\tfor (let i = 0; i < operationChain.length-1; i+=2) {\r\n\t\t\tlet operand1 = '';\r\n\t\t\tif (!resultBuffer) {\r\n\t\t\t\toperand1 = operationChain[i];\r\n\t\t\t} else {\r\n\t\t\t\toperand1 = resultBuffer;\r\n\t\t\t}\r\n\t\t\tlet operator = operationChain[i+1];\r\n\t\t\tlet operand2 = operationChain[i+2];\r\n\t\t\tresultBuffer = this.calculate(operand1, operator, operand2);\r\n\t\t}\r\n\t\treturn parseFloat(resultBuffer);\r\n\t}\r\n\t\r\n\tcalculate(operand1: string, operator: string, operand2: string): string {\r\n\t\tlet num1 = parseFloat(operand1);\r\n\t\tlet num2 = parseFloat(operand2);\r\n\t\tlet result = 0;\r\n\t\tswitch (operator) {\r\n\t\t\tcase \"+\":\r\n\t\t\t\tresult = num1 + num2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"-\":\r\n\t\t\t\tresult = num1 - num2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"×\":\r\n\t\t\t\tresult = num1 * num2;\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"÷\":\r\n\t\t\t\tresult = num1 / num2;\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn result.toString();\r\n\t}\r\n\t\r\n\tupdateLastPressed(item: string) {\r\n\t\tthis.lastPressed.push(item);\r\n\t\tif (this.lastPressed.length > 2) this.lastPressed.shift();\r\n\t}\r\n\t\r\n\tgetLastPressed() {\r\n\t\treturn parseFloat(this.lastPressed[0]);\r\n\t}\r\n\t\r\n\tequals() {\r\n\t\tif (this.fromHistory) return;\r\n\t\tlet result = 0;\r\n\t\tif (this.operationChain.length === 0) return;\r\n\t\tif (this.operationChain.length % 2 === 0) {\r\n\t\t\tthis.operationChain.push(this.displayResult);\r\n\t\t\tresult = this.perform(this.operationChain);\r\n\t\t} else { \r\n\t\t\t\r\n\t\t}\r\n\t\tlet operations = this.operationChain;\r\n\t\tthis.clearAll();\r\n\t\tthis.newResult = true;\r\n\t\tthis.appendResult(result);\r\n\t\tthis.newResult = true;\r\n\t\t// Add to history\r\n\t\tvar historyItem = new HistoryItem(operations, result);\r\n\t\tthis.history.unshift(historyItem);\r\n\t}\r\n\t\r\n\thistorySelected(item: HistoryItem) {\r\n\t\tvar historyChain = item.operationChain.slice(0, item.operationChain.length-1);  // Slice off the =\r\n\t\tthis.displayOperation = historyChain;\r\n\t\tthis.operationChain = historyChain.split(\" \");\r\n\t\tthis.operationChain.pop();  // Remove the blank item from the space\r\n\t\tthis.newResult = true;\r\n\t\tthis.appendResult(item.result);\r\n\t\tthis.newResult = true;\r\n\t\tthis.fromHistory = true;\r\n\t}\r\n\t\r\n\tclearAll() {\r\n\t\tthis.displayOperation = \"\";\r\n\t\tthis.displayResult = \"0\";\r\n\t\tthis.currentResult = 0;\r\n\t\tthis.operationChain = [];\r\n\t\tthis.lastPressed = [];\r\n\t\tthis.newResult = false;\r\n\t\tthis.fromHistory = false;\r\n\t}\r\n\r\n\tclearHistory() {\r\n\t\tthis.history = [];\r\n\t}\r\n\t\r\n\tdelete() {\r\n\t\tif (this.displayResult) {\r\n\t\t\tthis.displayResult = this.displayResult.slice(0, this.displayResult.length-1);\r\n\t\t}\r\n\t\tif (!this.displayResult) this.displayResult = \"0\";\r\n\t}\r\n\t\r\n}"],"sourceRoot":"/source/"}